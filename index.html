<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>114å¹´åº¦å“¡å·¥åº§è«‡æœƒææ¡ˆå¹³å°</title>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --cream: #FFF9F0; --warm-white: #FFFCF8; --soft-orange: #FFB088; --coral: #FF8C69;
      --warm-brown: #8B6F5C; --deep-brown: #6B5344; --text: #4A403A; --border: #F0E6DC;
      --shadow-soft: 0 12px 40px rgba(139, 111, 92, 0.12);
      --radius-lg: 32px; --radius-md: 20px;
    }
    *{ box-sizing:border-box; margin:0; padding:0; }
    body{ font-family: 'Noto Sans TC', sans-serif; color: var(--text); background: var(--cream); line-height:1.8; font-size: 18px; }
    .container{ width: min(1100px, 94vw); margin: 0 auto; padding-bottom: 50px; }
    
    /* é ‚éƒ¨ */
    .topbar{ position: sticky; top: 0; z-index: 20; background: rgba(255, 252, 248, 0.95); backdrop-filter: blur(15px); border-bottom: 1px solid var(--border); padding: 20px 0; }
    .inner{ display: flex; align-items: center; justify-content: space-between; }
    .brand{ font-weight: 700; color: var(--deep-brown); font-size: 22px; display: flex; align-items: center; gap: 10px; }
    
    /* Hero èˆ‡åœ–ç‰‡æ¯”ä¾‹ä¿®æ­£ */
    .hero{ margin-top: 30px; }
    .heroCard{ position: relative; overflow: hidden; border-radius: var(--radius-lg); box-shadow: var(--shadow-soft); height: 500px; background: #eee; }
    .heroCard img{ width: 100%; height: 100%; object-fit: cover; } /* é—œéµï¼šç¢ºä¿ç…§ç‰‡æ»¿ç‰ˆä¸è®Šå½¢ */
    .heroText{ position: absolute; left: 40px; right: 40px; bottom: 40px; }
    .heroText .title{ background: rgba(255, 252, 248, 0.98); border-radius: var(--radius-md); padding: 40px; box-shadow: 0 10px 30px rgba(0,0,0,0.15); }
    .heroText h1{ font-size: 44px; color: var(--deep-brown); margin: 0; line-height: 1.2; } /* æ¨™é¡ŒåŠ å¤§ */
    
    /* æº«é¦¨å¼•è¨€å€ */
    .quote-section{ margin: 40px 0; padding: 40px; background: #FFE4E1; border-radius: var(--radius-md); border-left: 8px solid var(--coral); display: flex; align-items: center; gap: 30px; }
    .quote-text{ font-size: 22px; font-weight: 500; font-style: italic; }

    /* è¶£å‘³äº’å‹• */
    .fun-section{ margin: 40px 0; padding: 40px; background: #FFF; border-radius: var(--radius-md); display: flex; align-items: center; gap: 40px; border: 3px dashed var(--soft-orange); }
    .fun-image{ width: 250px; height: 160px; border-radius: 15px; overflow: hidden; flex-shrink: 0; }
    .fun-image img{ width: 100%; height: 100%; object-fit: cover; }

    /* è¡¨å–®å€å¡Š */
    .section{ margin: 40px 0; padding: 60px; background: var(--warm-white); border-radius: var(--radius-lg); box-shadow: var(--shadow-soft); border: 1px solid var(--border); }
    .section-title h2{ font-size: 34px; color: var(--deep-brown); margin-bottom: 10px; }
    label{ display: block; font-weight: 700; font-size: 20px; margin: 30px 0 15px; }
    input, textarea{ width: 100%; border: 2px solid var(--border); border-radius: 15px; padding: 20px; font-size: 18px; outline: none; font-family: inherit; }
    
    /* AI æ¯”å°çµæœè¡¨æ ¼èª¿æ ¡ */
    .hint{ margin: 40px 0; background: white; border: 3px solid var(--soft-orange); border-radius: var(--radius-md); padding: 40px; display: none; box-shadow: 0 20px 50px rgba(0,0,0,0.1); }
    .hint-title{ font-size: 26px; font-weight: 700; color: var(--deep-brown); margin-bottom: 20px; }
    .hint-text{ font-size: 19px; background: var(--cream); padding: 25px; border-radius: 15px; margin-bottom: 30px; }
    .history-table { width: 100%; border-collapse: collapse; font-size: 18px; }
    .history-table th { background: var(--coral); color: white; padding: 20px; text-align: left; }
    .history-table td { padding: 20px; border-bottom: 1px solid var(--border); vertical-align: top; }

    /* æŒ‰éˆ• */
    .btn{ cursor: pointer; border-radius: 60px; padding: 20px 50px; font-weight: 700; font-size: 20px; border: none; transition: 0.3s; font-family: inherit; }
    .btnPrimary{ background: linear-gradient(135deg, var(--soft-orange), var(--coral)); color: #fff; width: 100%; }
    .btnGhost{ background: white; color: var(--warm-brown); border: 2px solid var(--border); margin-top: 30px; }
    
    /* æˆåŠŸé é¢ */
    .success{ display: none; padding: 100px 40px; background: white; border-radius: var(--radius-lg); text-align: center; }
    .success h3{ font-size: 48px; color: var(--deep-brown); }
  </style>
</head>
<body>
  <div class="topbar"><div class="container"><div class="inner"><div class="brand">ğŸ’¬ å“¡å·¥åº§è«‡æœƒæ„è¦‹å¹³å°</div><div id="today" style="font-weight:700;"></div></div></div></div>
  
  <main class="container" id="mainContent">
    <section class="hero">
      <figure class="heroCard">
        <img src="1770205128981.jpg" alt="Hero"/> <!-- ç¢ºä¿æ­¤æª”æ¡ˆåœ¨ GitHub æ ¹ç›®éŒ„ -->
      </figure>
      <div class="heroText"><div class="title"><h1>æ¯ä¸€ä»½å»ºè­°ï¼Œéƒ½æ˜¯æˆé•·çš„åŠ›é‡</h1><p>è®“æˆ‘å€‘ä¸€èµ·è½è¦‹åŸºå±¤çš„è²éŸ³ ğŸ’ª</p></div></div>
    </section>

    <div class="quote-section">âœ¨ <p class="quote-text">ã€Œæ‚¨çš„å»ºè­°ç„¡è«–å¤§å°ï¼Œéƒ½æ˜¯æˆ‘å€‘é€²æ­¥çš„å‹•åŠ›ã€‚ã€</p></div>

    <section class="section" id="formSection">
      <div class="section-title"><h2>å¡«å¯«æ‚¨çš„ææ¡ˆ</h2><p>AI Gemini 3 è‡ªå‹•èª¿é–±æ­·å¹´ç´€éŒ„é€²è¡Œæ¯”å°</p></div>
      
      <label>1. è«‹å•ææ¡ˆæ˜¯å¦å…·åï¼Ÿ</label>
      <div style="display:flex; gap:40px; margin-bottom:30px;">
        <label style="margin:0"><input type="radio" name="identity" value="named" onclick="toggleId(true)"> è¨˜ååæ˜ </label>
        <label style="margin:0"><input type="radio" name="identity" value="anon" checked onclick="toggleId(false)"> ä¸è¨˜ååæ˜ </label>
      </div>

      <div id="identitySection" style="display:none;">
        <label>å–®ä½/è·ç¨±/å§“å</label>
        <div style="display:grid; grid-template-columns: 1fr 1fr 1fr; gap:20px;">
          <input type="text" id="dept" placeholder="å–®ä½">
          <input type="text" id="jobTitle" placeholder="è·ç¨±">
          <input type="text" id="userName" placeholder="å§“å">
        </div>
      </div>

      <label>5. å»ºè­°äº‹é … (è¼¸å…¥å®Œé»æ“Šæ¡†å¤–è§¸ç™¼ AI)</label>
      <textarea id="suggestion" onblur="checkAI()" rows="6" placeholder="è«‹è¼¸å…¥å»ºè­°..."></textarea>

      <div class="hint" id="dupHint">
        <div class="hint-title">ğŸ’¡ æ­·æ¬¡è³‡æ–™æ¯”å°çµæœ</div>
        <div id="aiSummary" class="hint-text">æ­£åœ¨åˆ†ææ­·å¹´æª”æ¡ˆ...</div>
        <div id="historyTable"></div>
        <button class="btn btnGhost" onclick="document.getElementById('dupHint').style.display='none'">äº†è§£ï¼Œç¹¼çºŒå¡«å¯«</button>
      </div>

      <label>6. å…·é«”äº‹è­‰ / å»ºè­°æ–¹æ¡ˆ</label>
      <textarea id="evidence" rows="4"></textarea>

      <button class="btn btnPrimary" id="submitBtn" style="margin-top:50px;" onclick="submitForm()">ğŸ’Œ é€å‡ºå»ºè­°äº‹é …</button>
    </section>

    <section class="success" id="successBox">
      <h3>ğŸ‰ æ„Ÿè¬æ‚¨çš„åˆ†äº«</h3>
      <p style="font-size:24px; margin-top:20px;">æ‚¨çš„å»ºè­°å·²æˆåŠŸæ”¶æ‚‰ ğŸ’š</p>
      <img src="1769910482662.jpg" style="width:100%; max-width:600px; margin-top:50px; border-radius:20px;">
    </section>
  </main>

  <script>
    const GAS_URL = "https://script.google.com/macros/s/AKfycbzv6gx72y1isHEBnSnStT9-XPz61NZrYmba9wF8EwYEIoD5-RWZRnr5gXatAE8dO1VU/exec";
    document.getElementById('today').textContent = new Date().toLocaleDateString();

    function toggleId(s) { document.getElementById('identitySection').style.display = s ? 'block' : 'none'; }

    async function checkAI() {
      const q = document.getElementById('suggestion').value.trim();
      if (q.length < 5) return;
      document.getElementById('dupHint').style.display = 'block';
      document.getElementById('aiSummary').innerHTML = "ğŸ” æ­£åœ¨é€é Gemini 3 æ¯”å°æ­·å¹´è³‡æ–™...";
      
      try {
        const res = await fetch(GAS_URL, { method: "POST", body: JSON.stringify({ action: "query", query: q }) });
        const json = await res.json();
        if (json.status === "success") {
          document.getElementById('aiSummary').innerText = json.data.summary;
          let h = '<table class="history-table"><thead><tr><th>æ—¥æœŸ</th><th>è¨´æ±‚</th><th>è£ç¤º</th></tr></thead><tbody>';
          json.data.history.forEach(i => h += `<tr><td><b>${i.date}</b></td><td>${i.proposal}</td><td>${i.conclusion}</td></tr>`);
          document.getElementById('historyTable').innerHTML = h + '</tbody></table>';
        }
      } catch (e) { document.getElementById('aiSummary').innerText = "æ¯”å°æœå‹™æš«æ™‚ç„¡æ³•é€£ç·šã€‚"; }
    }

    async function submitForm() {
      const q = document.getElementById('suggestion').value.trim();
      if (!q) return alert("è«‹è¼¸å…¥å…§å®¹");
      document.getElementById('submitBtn').innerText = "æäº¤ä¸­...";
      
      const formData = {
        identity: document.querySelector('input[name="identity"]:checked').value,
        dept: document.getElementById('dept').value,
        jobTitle: document.getElementById('jobTitle').value,
        userName: document.getElementById('userName').value,
        suggestion: q,
        evidence: document.getElementById('evidence').value
      };

      try {
        const res = await fetch(GAS_URL, { method: "POST", body: JSON.stringify({ action: "save", formData: formData }) });
        const json = await res.json();
        if (json.status === "success") {
          document.getElementById('formSection').style.display = 'none';
          document.getElementById('successBox').style.display = 'block';
          window.scrollTo(0,0);
        }
      } catch (e) { alert("æäº¤å¤±æ•—"); }
    }
  </script>
</body>
</html>
