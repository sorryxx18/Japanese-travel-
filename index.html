<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>114å¹´åº¦å“¡å·¥åº§è«‡æœƒææ¡ˆå¹³å°</title>
  <!-- å¼•å…¥ç¾ä»£åŒ–æ€æºé»‘é«”ï¼Œå¾¹åº•å–ä»£ç´°æ˜é«” -->
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&display=swap" rel="stylesheet">
  <style>
    :root{
      /* æº«é¦¨é…è‰² - åŸå§‹è®Šæ•¸å®Œæ•´ä¿ç•™ */
      --cream: #FFF9F0;
      --warm-white: #FFFCF8;
      --soft-orange: #FFB088;
      --coral: #FF8C69;
      --warm-brown: #8B6F5C;
      --deep-brown: #6B5344;
      --sage: #A8B5A0;
      --soft-pink: #FFE4E1;
      --text: #4A403A;
      --text-light: #7A6B5F;
      --border: #F0E6DC;
      --shadow-soft: 0 8px 32px rgba(139, 111, 92, 0.12);
      --shadow-hover: 0 12px 40px rgba(139, 111, 92, 0.18);
      --radius-lg: 24px;
      --radius-md: 16px;
      --radius-sm: 12px;
    }

    *{ box-sizing:border-box; margin:0; padding:0; }

    body{
      /* å¼·åˆ¶è¨­å®šæ€æºé»‘é«”ï¼Œç¢ºä¿ä¸å‡ºç¾ç´°æ˜é«” */
      font-family: 'Noto Sans TC', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      color: var(--text);
      background: linear-gradient(180deg, var(--cream) 0%, var(--warm-white) 100%);
      min-height: 100vh;
      line-height:1.8;
      font-size: 16px; /* åŸºç¤å­—é«”æ”¾å¤§ */
    }

    .container{ width: min(900px, 94vw); margin: 0 auto; }

    /* é ‚éƒ¨å°èˆª */
    .topbar{
      position: sticky;
      top: 0;
      z-index: 20;
      background: rgba(255, 252, 248, 0.95);
      backdrop-filter: blur(12px);
      border-bottom: 1px solid var(--border);
      padding: 14px 0;
    }
    .topbar .inner{
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .brand{
      display: flex;
      align-items: center;
      gap: 10px;
      font-weight: 700;
      color: var(--deep-brown);
      font-size: 16px;
    }
    .brand-icon{
      width: 36px;
      height: 36px;
      background: linear-gradient(135deg, var(--soft-orange), var(--coral));
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
    }
    .badge{
      font-size: 12px;
      padding: 6px 14px;
      border-radius: 20px;
      color: var(--warm-brown);
      background: var(--soft-pink);
      font-weight: 500;
    }

    /* Hero å€åŸŸ - å®Œæ•´ä¿ç•™ */
    .hero{ margin-top: 24px; }
    .heroCard{
      position: relative;
      overflow: hidden;
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-soft);
      min-height: 380px;
    }
    .heroCard img{
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
      transition: transform 0.6s ease;
    }
    .heroCard:hover img{ transform: scale(1.03); }
    .heroOverlay{
      position: absolute;
      inset: 0;
      background: linear-gradient(180deg, rgba(107, 83, 68, 0) 0%, rgba(107, 83, 68, 0.7) 100%);
    }
    .heroText{
      position: absolute;
      left: 28px;
      right: 28px;
      bottom: 28px;
    }
    .heroText .title{
      background: rgba(255, 252, 248, 0.96);
      border-radius: var(--radius-md);
      padding: 28px 32px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.1);
    }
    .heroText h1{
      margin: 0;
      font-size: 28px;
      color: var(--deep-brown);
      font-weight: 700;
      letter-spacing: 0.5px;
    }
    .heroText p{
      margin-top: 10px;
      color: var(--text-light);
      font-size: 15px;
    }

    /* æº«é¦¨å¼•è¨€å€ - å®Œæ•´ä¿ç•™ */
    .quote-section{
      margin: 28px 0;
      padding: 24px 32px;
      background: linear-gradient(135deg, var(--soft-pink), #FFF0F5);
      border-radius: var(--radius-md);
      border-left: 4px solid var(--coral);
      display: flex;
      align-items: center;
      gap: 20px;
    }
    .quote-icon{ font-size: 36px; color: var(--coral); flex-shrink: 0; }
    .quote-text{ font-size: 16px; color: var(--text); font-style: italic; }

    /* è¶£å‘³äº’å‹•å€ - å®Œæ•´ä¿ç•™ */
    .fun-section{
      margin: 24px 0;
      padding: 24px;
      background: linear-gradient(135deg, #FFF8E7, var(--cream));
      border-radius: var(--radius-md);
      display: flex;
      align-items: center;
      gap: 24px;
      border: 2px dashed var(--soft-orange);
    }
    .fun-image{ width: 140px; height: 100px; border-radius: var(--radius-sm); overflow: hidden; flex-shrink: 0; box-shadow: 0 4px 12px rgba(0,0,0,0.15); }
    .fun-image img{ width: 100%; height: 100%; object-fit: cover; }
    .fun-text h3{ color: var(--deep-brown); font-size: 16px; margin-bottom: 6px; }
    .fun-text p{ color: var(--text-light); font-size: 14px; margin: 0; }

    /* è¡¨å–®å€åŸŸ - åŸå§‹çµæ§‹ */
    .section{
      margin: 24px 0;
      padding: 28px;
      background: var(--warm-white);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-soft);
      border: 1px solid var(--border);
    }
    .section-title{ display: flex; align-items: center; gap: 14px; margin-bottom: 24px; }
    .section-icon{ width: 48px; height: 48px; border-radius: var(--radius-sm); overflow: hidden; border: 2px solid var(--border); background: var(--cream); }
    .section-icon img{ width: 100%; height: 100%; object-fit: cover; }
    .section-title h2{ color: var(--deep-brown); font-size: 22px; font-weight: 700; }
    .section-title .sub{ color: var(--text-light); font-size: 13px; font-weight: 400; margin-top: 2px; }

    /* è¡¨å–®å…ƒç´  - åŠ å¤§å­—é«”èˆ‡è³ªæ„Ÿ */
    label{ display: block; font-weight: 600; color: var(--deep-brown); font-size: 16px; margin: 24px 0 10px; }
    label .required{ color: var(--coral); margin-left: 4px; }

    input[type="text"], textarea, select {
      width: 100%;
      border: 2px solid var(--border);
      border-radius: var(--radius-sm);
      padding: 16px 20px;
      font-size: 16px;
      outline: none;
      background: var(--warm-white);
      color: var(--text);
      transition: all 0.3s ease;
      font-family: inherit;
    }
    input[type="text"]:focus, textarea:focus {
      border-color: var(--soft-orange);
      box-shadow: 0 0 0 4px rgba(255, 176, 136, 0.15);
      background: #fff;
    }

    /* Radio æ¨£å¼ - å®Œæ•´ä¿ç•™ */
    .radio-group{
      display: flex;
      align-items: center;
      gap: 28px;
      margin-top: 12px;
      padding: 16px 20px;
      background: var(--cream);
      border-radius: var(--radius-sm);
      border: 2px solid var(--border);
    }
    .radio-option{ display: flex; align-items: center; gap: 10px; cursor: pointer; font-weight: 500; color: var(--text); }
    input[type="radio"]{ width: 20px; height: 20px; cursor: pointer; accent-color: var(--coral); }

    /* ğŸ’¡ AI æ­·å²å°æ¯”å€å¡Š - é‡å°å­—é«”èˆ‡ç‰ˆé¢å„ªåŒ– */
    .hint{
      margin-top: 20px;
      background: var(--warm-white);
      border: 2px solid var(--soft-orange);
      border-left: 8px solid var(--soft-orange);
      border-radius: var(--radius-md);
      padding: 30px;
      display: none;
      animation: slideIn 0.3s ease;
      box-shadow: var(--shadow-soft);
    }
    @keyframes slideIn{ from { opacity: 0; transform: translateY(-8px); } to { opacity: 1; transform: translateY(0); } }
    
    .hint-title{ color: var(--deep-brown); font-weight: 700; font-size: 18px; margin-bottom: 12px; display: flex; align-items: center; gap: 10px; }
    .hint-text{ font-size: 16px; color: var(--text); margin-bottom: 20px; line-height: 1.8; background: var(--cream); padding: 15px; border-radius: var(--radius-sm); }

    /* æ¯”å°è¡¨æ ¼ - å°ˆæ¥­ä¸”å¤§å­—é«” */
    .history-table-container { overflow-x: auto; border-radius: var(--radius-sm); border: 1px solid var(--border); }
    .history-table { width: 100%; border-collapse: collapse; background: white; font-size: 16px; }
    .history-table th { background: var(--coral); color: white; padding: 16px 12px; text-align: left; font-weight: 500; }
    .history-table td { padding: 16px 12px; border-bottom: 1px solid var(--border); color: var(--text); vertical-align: top; }
    .history-table tr:hover { background-color: var(--cream); }

    /* èº«ä»½å€åŸŸ - å®Œæ•´ä¿ç•™ */
    #identitySection{ display: none; animation: fadeIn 0.4s ease; padding-top: 10px; }
    @keyframes fadeIn{ from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
    .form-row{ display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }

    /* æŒ‰éˆ•æ¨£å¼ - å®Œæ•´ä¿ç•™ä¸¦å¾®èª¿ */
    .btn{
      appearance: none; border: none; cursor: pointer; border-radius: 50px;
      padding: 14px 28px; font-weight: 600; font-size: 16px; transition: all 0.3s ease; font-family: inherit;
    }
    .btnPrimary{
      background: linear-gradient(135deg, var(--soft-orange), var(--coral));
      color: #fff; box-shadow: 0 4px 16px rgba(255, 140, 105, 0.35);
    }
    .btnGhost{ background: transparent; color: var(--deep-brown); border: 2px solid var(--border); margin-top: 15px; }
    .btn-full{ width: 100%; padding: 16px; font-size: 18px; margin-top: 12px; }

    /* é™„ä»¶ä¸Šå‚³ - å®Œæ•´ä¿ç•™ */
    .upload-area{
      border: 3px dashed var(--border); border-radius: var(--radius-md);
      padding: 40px 30px; text-align: center; color: var(--text-light); font-size: 15px;
      cursor: pointer; background: var(--cream); transition: all 0.3s ease;
    }
    .upload-area:hover{ border-color: var(--soft-orange); background: #FFF5EE; }

    /* æˆåŠŸé é¢ - å®Œæ•´ä¿ç•™ */
    .success{
      display: none; margin: 24px 0; border-radius: var(--radius-lg); background: var(--warm-white);
      box-shadow: var(--shadow-soft); overflow: hidden; border: 1px solid var(--border); animation: fadeIn 0.5s ease;
    }
    .success-header{ padding: 36px; text-align: center; background: linear-gradient(135deg, var(--soft-pink), #FFF0F5); }
    .success-icon{ font-size: 64px; margin-bottom: 16px; }
    .success-header h3{ color: var(--deep-brown); font-size: 26px; margin-bottom: 12px; }
    .success-image{ width: 100%; height: 280px; object-fit: cover; display: block; }

    @media (max-width: 640px){
      .form-row{ grid-template-columns: 1fr; }
      .fun-section{ flex-direction: column; text-align: center; }
      .heroText h1{ font-size: 22px; }
    }
  </style>
</head>

<body>
  <div class="topbar">
    <div class="container">
      <div class="inner">
        <div class="brand">
          <span class="brand-icon">ğŸ’¬</span>
          <span>å“¡å·¥åº§è«‡æœƒæ„è¦‹å¹³å°</span>
        </div>
        <div style="display:flex; gap:10px; align-items:center;">
          <span class="badge">ğŸ’› å…§éƒ¨ä½¿ç”¨</span>
          <span class="badge" id="today" style="background: var(--cream);"></span>
        </div>
      </div>
    </div>
  </div>

  <main class="container">
    <!-- Hero å€åŸŸ - åŸå§‹åœ–ç‰‡èˆ‡çµæ§‹ -->
    <section class="hero">
      <figure class="heroCard">
        <img src="./1770205128981.jpg" alt="åœ˜éšŠè¨“ç·´ç¾å ´"/>
        <div class="heroOverlay"></div>
        <div class="heroText">
          <div class="title">
            <h1>æ¯ä¸€ä»½å»ºè­°ï¼Œéƒ½æ˜¯æˆé•·çš„åŠ›é‡</h1>
            <p>114å¹´åº¦å“¡å·¥åº§è«‡æœƒï¼šé€éæ‚¨çš„è²éŸ³ï¼Œè®“æˆ‘å€‘ä¸€èµ·è®Šå¾—æ›´å¥½ ğŸ’ª</p>
          </div>
        </div>
      </figure>
    </section>

    <!-- å¼•è¨€å€ - åŸå§‹çµæ§‹ -->
    <div class="quote-section">
      <span class="quote-icon">âœ¨</span>
      <p class="quote-text">ã€Œæ‚¨çš„æ¯ä¸€å€‹æƒ³æ³•éƒ½å¾ˆçè²´ï¼Œç„¡è«–å¤§å°ï¼Œéƒ½æ˜¯æˆ‘å€‘é€²æ­¥çš„å‹•åŠ›ã€‚è«‹æ”¾å¿ƒåˆ†äº«ï¼Œæˆ‘å€‘æœƒèªçœŸå‚¾è½ã€‚ã€</p>
    </div>

    <!-- è¶£å‘³å€ - åŸå§‹çµæ§‹ -->
    <div class="fun-section">
      <div class="fun-image">
        <img src="./266207be87b246eb8d2e11c63eb5d224.png" alt="è¼•é¬†ä¸€ä¸‹"/>
      </div>
      <div class="fun-text">
        <h3>ğŸ­ æœ‰è©±å°±èªªï¼Œä¸ç”¨å®¢æ°£ï¼</h3>
        <p>ä¸ç®¡æ˜¯é–‹å¿ƒçš„äº‹ã€å›°æ“¾çš„äº‹ï¼Œé‚„æ˜¯ã€Œèª°æ•¢æ¯”æˆ‘æ…˜ã€çš„ç¶“æ­·ï¼Œéƒ½æ­¡è¿åœ¨é€™è£¡åˆ†äº«ï½æˆ‘å€‘ä¸€èµ·æƒ³è¾¦æ³•ï¼</p>
      </div>
    </div>

    <!-- è¡¨å–®å€åŸŸ -->
    <section class="section" id="formSection">
      <div class="section-title">
        <div class="section-icon">
          <img src="./1770205128981.jpg" alt="åº§è«‡æœƒ"/>
        </div>
        <div>
          <h2>å¡«å¯«æ‚¨çš„ææ¡ˆ</h2>
          <p class="sub">é¡Œç›®åŸºåº•å®Œæ•´åƒç…§åŸå§‹å•å·æ ¼å¼</p>
        </div>
      </div>

      <div class="cardBody">
        <label style="font-size:16px;">1. è«‹å•æ‚¨æœ¬æ¬¡ææ¡ˆæ˜¯å¦å…·åï¼Ÿ <span class="required">*</span></label>
        <div class="radio-group">
          <label class="radio-option">
            <input type="radio" name="identity" value="named" onclick="toggleIdentity(true)">
            <span>è¨˜ååæ˜ </span>
          </label>
          <label class="radio-option">
            <input type="radio" name="identity" value="anon" onclick="toggleIdentity(false)">
            <span>ä¸è¨˜å (åŒ¿å)</span>
          </label>
        </div>

        <div id="identitySection">
          <label>2. å–®ä½ <span class="required">*</span></label>
          <input type="text" id="dept" placeholder="ä¾‹ï¼šè¨“ç·´ä¸­å¿ƒ">
          <div class="form-row">
            <div>
              <label>3. è·ç¨± <span class="required">*</span></label>
              <input type="text" id="jobTitle" placeholder="è·ç¨±">
            </div>
            <div>
              <label>4. å§“å <span class="required">*</span></label>
              <input type="text" id="userName" placeholder="çœŸå¯¦å§“å">
            </div>
          </div>
        </div>

        <label>5. å»ºè­°äº‹é … <span class="required">*</span></label>
        <textarea id="suggestion" onblur="checkAI()" rows="4" placeholder="è«‹è©³ç´°èªªæ˜æ‚¨çš„å»ºè­°æˆ–å•é¡Œé»..."></textarea>

        <!-- ğŸ’¡ AI æ­·æ¬¡å°æ¯”å€å¡Š (æ’å…¥é») -->
        <div class="hint" id="dupHint">
          <div class="hint-title">ğŸ’¡ æ­·æ¬¡è³‡æ–™æ¯”å°çµæœ</div>
          <div id="aiSummary" class="hint-text">æ­£åœ¨åˆ†ææ­·å¹´æª”æ¡ˆ...</div>
          <div class="history-table-container" id="historyTableContainer"></div>
          <button class="btn btnGhost" onclick="hideHint()">äº†è§£ï¼Œç¹¼çºŒå¡«å¯«å»ºè­°</button>
        </div>

        <label>6. å…·é«”äº‹è­‰ / å»ºè­°æ–¹æ¡ˆ</label>
        <textarea rows="3" placeholder="å¦‚å…¬æ–‡ç·¨è™Ÿã€ç›¸é—œé™„ä»¶èªªæ˜æˆ–æ‚¨çš„å…·é«”è§£æ±ºæ–¹æ¡ˆ..."></textarea>

        <label>7. é™„ä»¶</label>
        <div class="upload-area" onclick="alert('ğŸ“ é™„ä»¶ä¸Šå‚³åŠŸèƒ½ç¤ºç¯„')">
          <div class="upload-icon">ğŸ“</div>
          <div>é»æ“Šæˆ–æ‹–æ”¾æª”æ¡ˆè‡³æ­¤è™•ä¸Šå‚³</div>
          <div style="font-size:12px; margin-top:8px; color:#B8A99A;">æ”¯æ´ç…§ç‰‡ã€PDF æ ¼å¼</div>
        </div>

        <button class="btn btnPrimary btn-full" onclick="submitDemo()">
          ğŸ’Œ é€å‡ºå»ºè­°äº‹é …
        </button>
      </div>
    </section>

    <!-- æˆåŠŸç•«é¢ - åŸå§‹çµæ§‹ -->
    <section class="success" id="successBox">
      <div class="success-header">
        <div class="success-icon">ğŸ‰</div>
        <h3>æ„Ÿè¬æ‚¨çš„åˆ†äº«</h3>
        <p>æ‚¨çš„å»ºè­°å·²æˆåŠŸæ”¶æ‚‰ã€‚è¬è¬æ‚¨åœ¨ç¹å¿™å‹¤å‹™ä¸­é¡˜æ„ç•™ä¸‹å¯¶è²´å»ºè¨€ï¼Œè®“æˆ‘å€‘ä¸€èµ·å®ˆè­·å½¼æ­¤ã€å…±åŒæˆé•· ğŸ’š</p>
      </div>
      <img src="./1769910482662.jpg" class="success-image" alt="æ„Ÿè¬æœ‰æ‚¨"/>
    </section>
  </main>

  <script>
    // é¡¯ç¤ºä»Šæ—¥æ—¥æœŸ
    const d = new Date();
    document.getElementById('today').textContent = `ğŸ“… ${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,'0')}-${String(d.getDate()).padStart(2,'0')}`;

    function toggleIdentity(isNamed) {
      document.getElementById('identitySection').style.display = isNamed ? 'block' : 'none';
    }

    // AI æ¯”å°åŠŸèƒ½
    function checkAI() {
      const val = document.getElementById('suggestion').value.trim();
      if (val.length < 5) return;

      const hintBox = document.getElementById('dupHint');
      const summaryBox = document.getElementById('aiSummary');
      const tableContainer = document.getElementById('historyTableContainer');

      hintBox.style.display = 'block';
      summaryBox.innerHTML = '<span style="color:var(--warm-brown)">ğŸ” æ­£åœ¨æª¢ç´¢æ­·å¹´åº§è«‡æœƒè³‡æ–™åº«ï¼Œè«‹ç¨å€™...</span>';
      tableContainer.innerHTML = '';

      google.script.run
        .withSuccessHandler(function(res) {
          if (res.status === "success" && res.data) {
            summaryBox.innerText = res.data.summary;
            if (res.data.history && res.data.history.length > 0) {
              let html = '<table class="history-table"><thead><tr>';
              html += '<th style="width:20%">æ—¥æœŸ</th><th style="width:35%">è¨´æ±‚æ‘˜è¦</th><th style="width:45%">è£ç¤º/è¾¦ç†æƒ…å½¢</th>';
              html += '</tr></thead><tbody>';
              res.data.history.forEach(item => {
                html += `<tr><td><b>${item.date}</b></td><td>${item.proposal}</td><td>${item.conclusion}</td></tr>`;
              });
              html += '</tbody></table>';
              tableContainer.innerHTML = html;
            } else {
              summaryBox.innerText = "æ­¤è­°é¡Œåœ¨æ­·æ¬¡åº§è«‡æœƒä¸­æš«ç„¡ç›¸ä¼¼ç´€éŒ„ã€‚";
            }
          } else {
            summaryBox.innerText = "ç„¡æ³•å–å¾—æ¯”å°è³‡æ–™ï¼Œè«‹ç¹¼çºŒå¡«å¯«ã€‚";
          }
        })
        .withFailureHandler(function() {
          summaryBox.innerText = "ç³»çµ±é€£ç·šç•°å¸¸ã€‚";
        })
        .processWebQuery(val);
    }

    function hideHint() {
      document.getElementById('dupHint').style.display = 'none';
    }

    function submitDemo() {
      if(!document.getElementById('suggestion').value) return alert("è«‹å¡«å¯«å…§å®¹");
      document.getElementById('formSection').style.display = 'none';
      document.querySelector('.quote-section').style.display = 'none';
      document.querySelector('.fun-section').style.display = 'none';
      document.getElementById('successBox').style.display = 'block';
      window.scrollTo({top: 0, behavior: 'smooth'});
    }
  </script>
</body>
</html>
