<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>114å¹´åº¦å“¡å·¥åº§è«‡æœƒææ¡ˆå¹³å°</title>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --cream: #FFF9F0; --warm-white: #FFFCF8; --soft-orange: #FFB088; --coral: #FF8C69;
      --warm-brown: #8B6F5C; --deep-brown: #6B5344; --text: #4A403A; --text-light: #7A6B5F;
      --border: #F0E6DC; --shadow-soft: 0 12px 40px rgba(139, 111, 92, 0.12);
      --shadow-hover: 0 20px 50px rgba(139, 111, 92, 0.18);
      --radius-lg: 32px; --radius-md: 20px; --radius-sm: 14px;
    }
    *{ box-sizing:border-box; margin:0; padding:0; }
    body{ font-family: 'Noto Sans TC', sans-serif; color: var(--text); background: linear-gradient(180deg, var(--cream) 0%, var(--warm-white) 100%); min-height: 100vh; line-height:1.9; font-size: 17px; }
    .container{ width: min(1100px, 94vw); margin: 0 auto; }
    .topbar{ position: sticky; top: 0; z-index: 20; background: rgba(255, 252, 248, 0.95); backdrop-filter: blur(15px); border-bottom: 1px solid var(--border); padding: 18px 0; }
    .inner{ display: flex; align-items: center; justify-content: space-between; }
    .brand{ display: flex; align-items: center; gap: 12px; font-weight: 700; color: var(--deep-brown); font-size: 19px; }
    .brand-icon{ width: 42px; height: 42px; background: linear-gradient(135deg, var(--soft-orange), var(--coral)); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 20px; }
    .badge{ font-size: 14px; padding: 8px 18px; border-radius: 30px; color: var(--warm-brown); background: #FFE4E1; font-weight: 500; }
    .hero{ margin-top: 40px; }
    .heroCard{ position: relative; overflow: hidden; border-radius: var(--radius-lg); box-shadow: var(--shadow-soft); min-height: 480px; }
    .heroCard img{ width: 100%; height: 100%; object-fit: cover; display: block; }
    .heroOverlay{ position: absolute; inset: 0; background: linear-gradient(180deg, rgba(107, 83, 68, 0) 20%, rgba(107, 83, 68, 0.75) 100%); }
    .heroText{ position: absolute; left: 40px; right: 40px; bottom: 40px; }
    .heroText .title{ background: rgba(255, 252, 248, 0.97); border-radius: var(--radius-md); padding: 40px 50px; box-shadow: 0 10px 30px rgba(0,0,0,0.15); max-width: 850px; }
    .heroText h1{ margin: 0; font-size: 42px; color: var(--deep-brown); font-weight: 700; line-height: 1.3; }
    .quote-section{ margin: 45px 0; padding: 35px 45px; background: #FFE4E1; border-radius: var(--radius-md); border-left: 6px solid var(--coral); display: flex; align-items: center; gap: 30px; }
    .fun-section{ margin: 45px 0; padding: 35px; background: #FFF9F0; border-radius: var(--radius-md); display: flex; align-items: center; gap: 40px; border: 3px dashed var(--soft-orange); }
    .fun-image{ width: 220px; height: 150px; border-radius: var(--radius-sm); overflow: hidden; flex-shrink: 0; }
    .section{ margin: 45px 0; padding: 50px; background: var(--warm-white); border-radius: var(--radius-lg); box-shadow: var(--shadow-soft); border: 1px solid var(--border); }
    .section-title{ display: flex; align-items: center; gap: 20px; margin-bottom: 40px; }
    .section-icon{ width: 60px; height: 60px; border-radius: var(--radius-sm); overflow: hidden; border: 2px solid var(--border); }
    label{ display: block; font-weight: 700; color: var(--deep-brown); font-size: 18px; margin: 35px 0 15px; }
    .required{ color: var(--coral); margin-left: 5px; }
    input[type="text"], textarea { width: 100%; border: 2px solid var(--border); border-radius: var(--radius-sm); padding: 20px; font-size: 17px; outline: none; background: white; font-family: inherit; }
    .radio-group{ display: flex; gap: 40px; margin-top: 15px; padding: 25px 35px; background: var(--cream); border-radius: var(--radius-sm); border: 2px solid var(--border); }
    .radio-option{ display: flex; align-items: center; gap: 12px; cursor: pointer; font-size: 18px; font-weight: 500; }
    #identitySection{ display: none; margin-top: 20px; animation: slideIn 0.4s ease; }
    .form-row{ display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
    .hint{ margin: 40px 0; background: white; border: 2px solid var(--soft-orange); border-left: 10px solid var(--soft-orange); border-radius: var(--radius-md); padding: 40px; display: none; box-shadow: 0 20px 50px rgba(139, 111, 92, 0.18); }
    .hint-title{ color: var(--deep-brown); font-weight: 700; font-size: 24px; margin-bottom: 20px; }
    .hint-text{ font-size: 18px; line-height: 1.8; background: var(--cream); padding: 25px; border-radius: var(--radius-sm); border: 1px solid var(--border); }
    .history-table { width: 100%; border-collapse: collapse; background: white; font-size: 17px; margin-top: 20px; }
    .history-table th { background: var(--coral); color: white; padding: 18px; text-align: left; }
    .history-table td { padding: 18px; border-bottom: 1px solid var(--border); }
    .btn{ appearance: none; border: none; cursor: pointer; border-radius: 60px; padding: 18px 45px; font-weight: 700; font-size: 18px; transition: 0.3s; font-family: inherit; }
    .btnPrimary{ background: linear-gradient(135deg, var(--soft-orange), var(--coral)); color: #fff; }
    .btnGhost{ background: white; color: var(--warm-brown); border: 2px solid var(--border); margin-top: 25px; }
    .success{ display: none; margin: 50px 0; border-radius: var(--radius-lg); background: white; overflow: hidden; border: 1px solid var(--border); text-align: center; }
    @keyframes slideIn{ from { opacity: 0; transform: translateY(-15px); } to { opacity: 1; transform: translateY(0); } }
  </style>
</head>
<body>
  <div class="topbar"><div class="container"><div class="inner"><div class="brand"><span class="brand-icon">ğŸ’¬</span><span>å“¡å·¥åº§è«‡æœƒæ„è¦‹å¹³å°</span></div><div style="display:flex; gap:15px;"><span class="badge">ğŸ’› å…§éƒ¨å°ˆç”¨</span><span class="badge" id="today"></span></div></div></div></div>
  <main class="container">
    <section class="hero"><figure class="heroCard"><img src="./1770205128981.jpg" alt="Hero"/><div class="heroOverlay"></div><div class="heroText"><div class="title"><h1>æ¯ä¸€ä»½å»ºè­°ï¼Œéƒ½æ˜¯æˆé•·çš„åŠ›é‡</h1><p>114å¹´åº¦å“¡å·¥åº§è«‡æœƒï¼šè®“æˆ‘å€‘ä¸€èµ·è®Šå¾—æ›´å¥½ ğŸ’ª</p></div></div></figure></section>
    <div class="quote-section"><span style="font-size:48px">âœ¨</span><p class="quote-text">ã€Œæ‚¨çš„æ¯ä¸€å€‹æƒ³æ³•éƒ½å¾ˆçè²´ã€‚ç„¡è«–å¤§å°ï¼Œéƒ½æ˜¯æˆ‘å€‘é€²æ­¥çš„å‹•åŠ›ã€‚æˆ‘å€‘æœƒèªçœŸå‚¾è½ã€‚ã€</p></div>
    <div class="fun-section"><div class="fun-image"><img src="./266207be87b246eb8d2e11c63eb5d224.png" alt="Fun"/></div><div class="fun-text"><h3>ğŸ­ æœ‰è©±å°±èªªï¼Œä¸ç”¨å®¢æ°£ï¼</h3><p>ä¸ç®¡æ˜¯é–‹å¿ƒçš„äº‹ã€å›°æ“¾çš„äº‹ï¼Œéƒ½æ­¡è¿åœ¨é€™è£¡åˆ†äº«ã€‚æˆ‘å€‘ä¸€èµ·å°‹æ‰¾è§£æ±ºæ–¹æ¡ˆï¼</p></div></div>
    <section class="section" id="formSection">
      <div class="section-title"><div class="section-icon"><img src="./1770205128981.jpg" alt="Icon"/></div><div><h2>å¡«å¯«æ‚¨çš„ææ¡ˆ</h2><p>AI è‡ªå‹•æª¢ç´¢æ­·å¹´è³‡æ–™åº«</p></div></div>
      <div class="cardBody">
        <label>1. è«‹å•æ‚¨æœ¬æ¬¡ææ¡ˆæ˜¯å¦å…·åï¼Ÿ <span class="required">*</span></label>
        <div class="radio-group">
          <label class="radio-option"><input type="radio" name="identity" value="named" onclick="toggleIdentity(true)"><span>è¨˜ååæ˜ </span></label>
          <label class="radio-option"><input type="radio" name="identity" value="anon" id="radioAnon" checked onclick="toggleIdentity(false)"><span>ä¸è¨˜å (åŒ¿å)</span></label>
        </div>
        <div id="identitySection">
          <label>2. å–®ä½ <span class="required">*</span></label><input type="text" id="dept" placeholder="ä¾‹ï¼šäººäº‹å®¤ / å¤–å‹¤åˆ†éšŠ">
          <div class="form-row">
            <div><label>3. è·ç¨± <span class="required">*</span></label><input type="text" id="jobTitle" placeholder="è·ç¨±"></div>
            <div><label>4. å§“å <span class="required">*</span></label><input type="text" id="userName" placeholder="çœŸå¯¦å§“å"></div>
          </div>
        </div>
        <label>5. å»ºè­°äº‹é … <span class="required">*</span></label>
        <textarea id="suggestion" onblur="checkAI()" rows="6" placeholder="è«‹è©³ç´°èªªæ˜æ‚¨çš„å»ºè­°æˆ–å•é¡Œé»..."></textarea>
        <!-- AI å›è¦†å€ -->
        <div class="hint" id="dupHint">
          <div class="hint-title">ğŸ’¡ æ­·æ¬¡è³‡æ–™æ¯”å°çµæœ</div>
          <div id="aiSummary" class="hint-text">æ­£åœ¨åˆ†ææ­·å¹´æª”æ¡ˆ...</div>
          <div id="historyTableContainer"></div>
          <button class="btn btnGhost" onclick="hideHint()">äº†è§£ï¼Œç¹¼çºŒå¡«å¯«</button>
        </div>
        <label>6. å…·é«”äº‹è­‰ / å»ºè­°æ–¹æ¡ˆ</label><textarea id="evidence" rows="4" placeholder="ç›¸é—œå…¬æ–‡ç·¨è™Ÿã€æ•¸æ“šæˆ–è§£æ±ºæ–¹æ¡ˆ..."></textarea>
        <label>7. é™„ä»¶ (é¸å¡«)</label>
        <div style="border: 3px dashed var(--border); padding: 40px; text-align: center; background: var(--cream); cursor: pointer;" onclick="alert('é™„ä»¶è«‹éš¨è¡¨å–®è‡ªå‹•å­˜æª”')">ğŸ“ é»æ“Šæˆ–æ‹–æ”¾æª”æ¡ˆè‡³æ­¤è™•ä¸Šå‚³</div>
        <button class="btn btnPrimary" id="submitBtn" style="width:100%; margin-top:40px;" onclick="submitForm()">ğŸ’Œ é€å‡ºå»ºè­°äº‹é …</button>
      </div>
    </section>
    <section class="success" id="successBox">
      <div style="padding:80px"><div style="font-size:100px">ğŸ‰</div><h3>æ„Ÿè¬æ‚¨çš„åˆ†äº«</h3><p>æ‚¨çš„å»ºè­°å·²æˆåŠŸæ”¶æ‚‰ ğŸ’š</p></div>
      <img src="./1769910482662.jpg" style="width:100%; height:400px; object-fit:cover" alt="Success"/>
    </section>
  </main>
  <script>
    // --- é‡è¦ï¼šä¿®æ”¹æ­¤è™•ç¶²å€ ---
    const GAS_URL = "https://script.google.com/macros/s/AKfycbzJN-ySCeKKjpJeT48YdkYaWrHZKITDan6HfWi9w3SHjrlcjwlsmgMkJ-ZcFo-0qDbz/exec";

    document.getElementById('today').textContent = `ğŸ“… ${new Date().toLocaleDateString()}`;
    function toggleIdentity(s) { document.getElementById('identitySection').style.display = s ? 'block' : 'none'; }
    function hideHint() { document.getElementById('dupHint').style.display = 'none'; }

    // ã€å°æ¥ 1ï¼šAI æ¯”å°ã€‘
    async function checkAI() {
      const query = document.getElementById('suggestion').value.trim();
      if (query.length < 5) return;
      const hintBox = document.getElementById('dupHint');
      const summaryBox = document.getElementById('aiSummary');
      const tableContainer = document.getElementById('historyTableContainer');
      hintBox.style.display = 'block';
      summaryBox.innerHTML = 'ğŸ” æ­£åœ¨æ¯”å°æ­·å¹´è³‡æ–™ï¼Œè«‹ç¨å€™...';
      tableContainer.innerHTML = '';

      try {
        const response = await fetch(GAS_URL, {
          method: "POST",
          body: JSON.stringify({ action: "query", query: query })
        });
        const res = await response.json();
        if (res.status === "success" && res.data) {
          summaryBox.innerText = res.data.summary;
          if (res.data.history && res.data.history.length > 0) {
            let html = '<table class="history-table"><thead><tr><th>æ—¥æœŸ</th><th>è¨´æ±‚æ‘˜è¦</th><th>è£ç¤ºå…§å®¹</th></tr></thead><tbody>';
            res.data.history.forEach(item => {
              html += `<tr><td><b>${item.date}</b></td><td>${item.proposal}</td><td>${item.conclusion}</td></tr>`;
            });
            tableContainer.innerHTML = html + '</tbody></table>';
          }
        } else { summaryBox.innerText = "ç›®å‰æŸ¥ç„¡ç›´æ¥ç›¸é—œç´€éŒ„ï¼Œæ­¡è¿æå‡ºæ‚¨çš„æ–°è¦‹è§£ã€‚"; }
      } catch (e) { summaryBox.innerText = "æ¯”å°æœå‹™æš«æ™‚é€£ç·šä¸­ï¼Œè«‹ç¹¼çºŒå¡«å¯«ã€‚"; }
    }

    // ã€å°æ¥ 2ï¼šå­˜æª”ã€‘
    async function submitForm() {
      const suggestion = document.getElementById('suggestion').value.trim();
      if (!suggestion) return alert("è«‹è¼¸å…¥å»ºè­°äº‹é …");
      const btn = document.getElementById('submitBtn');
      btn.disabled = true; btn.innerText = "æ­£åœ¨é€å‡º...";

      const formData = {
        identity: document.querySelector('input[name="identity"]:checked').value,
        dept: document.getElementById('dept').value,
        jobTitle: document.getElementById('jobTitle').value,
        userName: document.getElementById('userName').value,
        suggestion: suggestion,
        evidence: document.getElementById('evidence').value
      };

      try {
        const response = await fetch(GAS_URL, {
          method: "POST",
          body: JSON.stringify({ action: "save", formData: formData })
        });
        const res = await response.json();
        if (res.status === "success") {
          document.getElementById('formSection').style.display = 'none';
          document.getElementById('successBox').style.display = 'block';
          window.scrollTo(0,0);
        } else { throw new Error(res.message); }
      } catch (e) {
        alert("é€å‡ºå¤±æ•—ï¼Œè«‹æª¢æŸ¥ç¶²è·¯æˆ–ç¨å¾Œå†è©¦ã€‚");
        btn.disabled = false; btn.innerText = "ğŸ’Œ é‡è©¦é€å‡ºå»ºè­°äº‹é …";
      }
    }
  </script>
</body>
</html>
